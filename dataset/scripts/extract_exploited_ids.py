import pandas as pd
import re

def extract_exploited_cves(file_path):
    """
    Reads a CSV file containing exploit data,
    extracts all CVE IDs from the 'codes' column,
    and returns a set of unique CVE IDs.
    """
    df = pd.read_csv(file_path)

    cve_ids = set()
    for entry in df['codes'].dropna():
        matches = re.findall(r'CVE-\d{4}-\d{4,7}', entry)
        cve_ids.update(matches)

    return cve_ids

# Example usage
file_path = 'files_exploits.csv'  # replace with your actual path
exploited_cves = extract_exploited_cves(file_path)

# Save to file for later matching
with open('exploited_cve_ids.txt', 'w') as f:
    for cve in sorted(exploited_cves):
        f.write(cve + '\n')
