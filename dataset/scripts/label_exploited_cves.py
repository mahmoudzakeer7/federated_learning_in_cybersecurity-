import pandas as pd

# Load your full dataset
df = pd.read_csv("nvd_cves1.csv")

# Load the exploited CVE list
try:
    exploited = pd.read_csv("exploited_cves1.csv")  # If it has a column like 'CVE-ID'
    exploited_set = set(exploited.iloc[:, 0].dropna().unique())
except:
    with open("exploited_cves.txt") as f:
        exploited_set = set(line.strip() for line in f if line.strip())

# Create binary label
df['label'] = df['id'].apply(lambda x: 1 if x in exploited_set else 0)

# Save the labeled dataset
df.to_csv("labeled_cves.csv", index=False)

print("Labeling complete. Saved to 'labeled_cves.csv'")
